import{E as j,a as z}from"./el-skeleton-item-1.2.2.js";import{E as G}from"./el-popover-1.2.2.js";import{E as L}from"./el-dialog-1.2.2.js";import{_ as T,u as U,k as Q,l as F,r as n,m as P,w as H,p as J,q as K,t as W,s as X,v as Y,E as S,x as Z,c as r,o as c,d,e as p,f as s,j as u,y as m,i as t,z as h,h as D,n as q,A as ss}from"./entry-1.2.2.js";import"./el-popper-1.2.2.js";import{R as es}from"./refresh-1.2.2.js";import"./index-1.2.25.js";const ts={class:"wrap"},ls={class:"box"},os={class:"head"},as={class:"discount_time"},ns={class:"swing animated"},is={class:"tips"},rs={class:"p1"},cs={class:"original-price"},ds={key:0},ps={key:1},us={class:"discount-price"},ms={class:"p3"},gs={class:"body"},vs={class:"qrcode-img"},fs=["src"],_s={class:"circle"},ws={class:"btn"},hs={__name:"Pay",props:{show:{type:Boolean,required:!0,default:!1}},setup(O,{emit:B}){const R=U(),I=O,M=Q(()=>F().$darkMode.isDarkMode.value?"dark":"light");let g;const a=n(!0),v=n(!1),k=n(""),f=n(!1),i=n(!1),_=n(!1);let l=P({});const V=B,y=()=>{clearInterval(g),R.setModal("pay",!1),f.value=!1,a.value=!0,k.value=null,l=P({}),_.value=!1};H(()=>I.show,o=>{o&&(J(k),C())});const C=()=>{_.value=!1,a.value=!0,K().then(o=>{let e=0;l=o.pList[0],l.GroupBuyRemark=l.GroupBuyRemark.replace(new RegExp(`${l.CurrentPrice}元`,"g"),""),W({PID:l.ID,PaymentID:17}).then(b=>{const{payUrl:x,OrderID:w}=b;Object.assign(l,{payUrl:x,OrderID:w}),g=X(()=>{if(e>=60){clearInterval(g);return}E(w),e++},2e3)}),setTimeout(()=>{f.value=!0},750)}).catch(o=>{_.value=!0,a.value=!1,console.error("[捕获请求超时]:",o)})},E=o=>{if(!o){if(clearInterval(g),v.value)return;v.value=!0}Y({OrderID:o||l.OrderID}).then(e=>{e.S==="1"&&e.OrderModel[0].Status==="1"?(S.success("支付成功~"),y(),V("success")):o||S({type:"warning",message:"未查询到购买成功的结果,如有问题请点击联系客服",grouping:!0})}).finally(()=>v.value=!1)};return(o,e)=>{const b=z,x=j,w=G,N=L,A=Z("wave");return c(),r("div",null,[d(N,{modelValue:I.show,width:"450px","destroy-on-close":"",style:{padding:"0"},"close-on-click-modal":!1,onClose:y,"show-close":!1},{default:p(()=>[s("img",{class:"close",onClick:y,src:"https://static.ppkao.com/www/images/icon-close.png"}),s("div",ts,[s("div",ls,[s("div",os,[e[4]||(e[4]=s("img",{src:"https://static.ppkao.com/www/images/bg-tip.png"},null,-1)),s("p",as,[e[3]||(e[3]=u("优惠倒计时： ")),s("span",ns,m(t(k)),1)])]),s("div",is,[s("p",rs,m(t(l).GroupBuyRemark),1),s("p",{class:h({"show-discount":t(f),price:!0})},[s("span",cs,[t(f)?(c(),r("span",ds,"原价")):D("",!0),t(l).OrigPrice?(c(),r("span",ps,m(t(l).OrigPrice)+"元",1)):D("",!0)]),s("span",us,m(t(l).CurrentPrice)+"元",1)],2),s("p",ms,m(t(l).Remarks),1)]),s("div",gs,[s("div",{class:h(["qrcode-box",{"show-desc":t(i)}])},[s("div",vs,[d(x,{style:{width:"200px"},loading:t(a),animated:""},{template:p(()=>[d(b,{variant:"image",style:{width:"200px",height:"200px"}})]),default:p(()=>e[5]||(e[5]=[s("img",{class:"icon",src:"https://static.ppkao.com/www/images/icon-wechatpay.png"},null,-1)])),_:1},8,["loading"]),s("img",{class:"qrcode",src:t(l).payUrl,style:q({opacity:t(a)?"0":"1"}),onLoad:e[0]||(e[0]=$=>a.value=!1)},null,44,fs),t(_)?(c(),r("div",{key:0,class:"timeout-box",onClick:C},[d(t(es))])):D("",!0)]),e[6]||(e[6]=s("div",{class:"footer"},[s("img",{src:"https://static.ppkao.com/www/images/icon-scan.png"}),s("p",null,[u(" 打开微信扫一扫"),s("br"),u(" 扫描二维码付款 ")])],-1))],2),s("div",{class:h(["desc-table",{"hide-table":!t(i)}])},e[7]||(e[7]=[s("div",{class:"table-box"},[s("p",null,"1. 搜题包次数扣减规则："),s("table",null,[s("thead",null,[s("tr",null,[s("th",{rowspan:"2"},"功能(查看答案)"),s("th",{colspan:"2"},"扣减规则")]),s("tr",null,[s("th",null,"基础费"),s("th",null,[u("加收费"),s("br"),u("（AI功能）")])])]),s("tbody",null,[s("tr",null,[s("td",null,"文字搜题"),s("td",null,"1次/题"),s("td",null,"0/每次")]),s("tr",null,[s("td",null,"语音搜题"),s("td",null,"1次/题"),s("td",null,"0/每次")]),s("tr",null,[s("td",null,"拍照识别"),s("td",null,"1次/题"),s("td",null,"0/每次")])])]),s("p",null,"2.充值条款：搜题次数单价0.2元/次，本搜题包为优惠套餐，不退款，过期后不进行补发或延长有效期")],-1)]),2),s("div",{class:"description",onClick:e[1]||(e[1]=$=>i.value=!t(i))},[s("div",_s,[s("div",{class:"triangle",style:q({transform:t(i)?"rotate(180deg)":"rotate(0deg)"})},null,4)]),e[8]||(e[8]=s("span",null,"权益说明",-1))])])]),s("div",ws,[ss((c(),r("button",{onClick:e[2]||(e[2]=()=>E()),class:h({loading:t(v)})},e[9]||(e[9]=[s("img",{src:"https://static.ppkao.com/www/images/icon-refresh.png"},null,-1),s("span",null,"点击查询支付结果",-1)]),2)),[[A]]),d(w,{trigger:"click",placement:"top",effect:t(M)},{reference:p(()=>e[10]||(e[10]=[s("span",{class:"kf-btn"},"已付款但还是不能看答案？",-1)])),default:p(()=>[e[11]||(e[11]=s("div",{class:"kf-box"},[s("img",{src:"https://static.ppkao.com/public/wxqrcode/pptiku.jpg",alt:"联系客服"}),s("span",null,"微信扫一扫后联系客服")],-1))]),_:1},8,["effect"])])])]),_:1},8,["modelValue"])])}}},Es=T(hs,[["__scopeId","data-v-4a2bb42d"]]);export{Es as default};
