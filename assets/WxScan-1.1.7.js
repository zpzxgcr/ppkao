import{E as q,a as E}from"./el-skeleton-item-1.1.7.js";import{E as I}from"./el-dialog-1.1.7.js";import{_ as V,u as B,a as N,r,w as W,g as R,s as U,b as L,c as g,o as _,d,e as m,f as e,h as M,i as a,n as Q,j as f}from"./entry-1.1.7.js";import"./index-1.1.75.js";const j={class:"dialog-box"},z={class:"wrap"},D={class:"box"},F={class:"qrcode-box"},T={class:"qrcode-img"},$=["src"],A={__name:"WxScan",props:{show:{type:Boolean,required:!0,default:!1},loginSuccess:{type:Function}},setup(w,{emit:v}){const x=B(),h=N(),p=w;let l;const o=r(!0),n=r(""),c=r(!1),k=v,i=()=>{clearInterval(l),n.value="",o.value=!0,x.setModal("scan",!1)};W(()=>p.show,t=>{t&&u()});const u=()=>{R().then(t=>{let s=0;n.value=t.QRCode,c.value=!1,l=U(()=>{if(s>=90){clearInterval(l),c.value=!0;return}S(t.Code),s++},1e3)})},S=t=>{L(t).then(s=>{s.S==="1"&&(h.setUserInfo(s.UserList[0]),i(),k("success"))})};return(t,s)=>{const y=E,b=q,C=I;return _(),g("div",j,[d(C,{modelValue:p.show,width:"460px","destroy-on-close":"",style:{padding:"0"},"close-on-click-modal":!1,onClose:i,"show-close":!1},{default:m(()=>[e("img",{class:"close",onClick:i,src:"https://static.ppkao.com/www/images/icon-close.png"}),e("div",z,[s[3]||(s[3]=e("img",{class:"scan-bg",src:"https://static.ppkao.com/www/images/scan-bg.png"},null,-1)),s[4]||(s[4]=e("img",{class:"scan-man",src:"https://static.ppkao.com/www/images/scan-man.png"},null,-1)),e("div",D,[e("div",F,[e("div",T,[d(b,{style:{width:"220px"},loading:a(o),animated:""},{template:m(()=>[d(y,{variant:"image",style:{width:"220px",height:"220px"}})]),default:m(()=>s[1]||(s[1]=[e("div",{class:"icon-box"},[e("img",{class:"icon",src:"https://static.ppkao.com/www/images/wx-icon.png"})],-1)])),_:1},8,["loading"]),e("img",{class:"qrcode",src:a(n),style:Q({opacity:a(o)?"0":"1"}),onLoad:s[0]||(s[0]=G=>o.value=!1)},null,44,$),a(c)?(_(),g("div",{key:0,class:"timeout-box",onClick:u},s[2]||(s[2]=[e("span",null,[f("二维码已过期"),e("br"),f("点击刷新")],-1)]))):M("",!0)])])])])]),_:1},8,["modelValue"])])}}},P=V(A,[["__scopeId","data-v-e3544c39"]]);export{P as default};
